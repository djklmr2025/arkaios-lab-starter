services:
  - type: web
    name: arkaios-api
    env: node
    plan: free
    buildCommand: npm i -g pnpm@9 && pnpm install --no-frozen-lockfile && pnpm --filter @arkaios/api build
    startCommand: pnpm --filter @arkaios/api start
    healthCheckPath: /health
    autoDeploy: true
    envVars:
      - key: AIDA_GATEWAY_URL
        sync: false
      - key: AIDA_AUTH_TOKEN
        sync: false
      - key: SERVE_STATIC
        value: "false"

  # Servicio MCP HTTP para fallback LAB desde arkaios-service-proxy
  - type: web
    name: arkaios-lab-mcp
    env: node
    plan: free
    buildCommand: npm i -g pnpm@9 && pnpm install --no-frozen-lockfile
    startCommand: node apps/mcp/http.mjs
    healthCheckPath: /mcp/health
    autoDeploy: true
    envVars:
      - key: MCP_HTTP_PORT
        value: "10000"
      - key: AIDA_GATEWAY_URL
        sync: false
      - key: AIDA_AUTH_TOKEN
        sync: false
      - key: LOCAL_BASE
        sync: false
